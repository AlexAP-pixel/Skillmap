<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="http://127.0.0.1:8000/static/Logo.ico">
    <title>Test</title>
    <script src="https://kit.fontawesome.com/3a2cbdeb4d.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="http://127.0.0.1:8000/static/Formulario_Chaside/styles.css">
    <style>
      body{display: block;}
      header{opacity: 0;}
    </style>
</head>
<body>
  <header>
    <img class="logoimg" src="http://127.0.0.1:8000/static/Login/Logo.png">
    <span class="logo">Skillmap</span>
    <nav>
        <div id="navbar">
            <a href="http://127.0.0.1:8000/Skillmap/Inicio">Inicio</a>
            <a href="http://127.0.0.1:8000/Skillmap/Dashboard">Mi cuenta</a>
            <a href="http://127.0.0.1:8000/Skillmap/AboutUs">Acerca de</a>
            <a href="http://127.0.0.1:8000/Skillmap/Contacto">Contacto</a>
            <a href="#" id="cerrar_sesion">Cerrar sesión</a>
        </div>
    </nav>
  </header>
  <br>
  <div class="centered-container">
    <div class="form-container">
        <form id="vocational-form">
            <h1>Test De Orientación Vocacional Chaside</h1>
            <div class="questions-container">
              <!--
                Mayoría de 1: Carreras como Ingeniería e n Computación, Ingeniería en Informática, Licenciatura en Ciencia de Datos.
                Mayoría de 2: Ingeniería Ambiental, Ingeniería en Energía, Ingeniería en Negocios Energéticos Sustentables.
                Mayoría de 3: Ingeniería Civil, Ingeniero Arquitecto, Ingeniería Topográfica y Fotogramétrica.
                Mayoría de 4: Licenciatura en Física y Matemáticas, Ingeniería Matemática, Ingeniería Mecánica.
              -->

                <!-- Pregunta 45 -->
                <label for="res45">45.  ¿Tolerarías empezar tantas veces como fuere necesario hasta obtener el logro deseado?  </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res45" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res45" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 46 -->
                <label for="res46">46. ¿Distribuís tu horarios del día adecuadamente para poder hacer todo lo planeado? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res46" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res46" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 47 -->
                <label for="res47">47.  ¿Harías un curso para aprender a fabricar los instrumentos y/o piezas de las máquinas o aparatos con que trabajas? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res47" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res47" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 48 -->
                <label for="res48">48.  ¿Elegirías una profesión en la tuvieras que estar algunos meses alejado de tu familia, por ejemplo el marino? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res48" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res48" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 49 -->
                <label for="res49">49. ¿Te radicarías en una zona agrícola-ganadera para desarrollar tus actividades como profesional?</label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res49" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res49" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 50 -->
                <label for="res50">50. ¿Cuando estás en un grupo trabajando, te entusiasma producir ideas originales y que sean tenidas en cuenta?</label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res50" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res50" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 51 -->
                <label for="res51">51. ¿Te resulta fácil coordinar un grupo de trabajo? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res51" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res51" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 52 -->
                <label for="res52">52.  ¿Te resultó interesante el estudio de las ciencias biológicas? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res52" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res52" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 53 -->
                <label for="res53">53.  ¿Si una gran empresa solicita un profesional como gerente de comercialización, te sentirías a gusto desempeñando ese rol? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res53" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res53" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 54 -->
                <label for="res54">54.   ¿Te incluirías en un proyecto nacional de desarrollo de la principal fuente de recursos de tu provincia?  </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res54" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res54" value="B">                    
                    <label for="areaB">No</label>
                </div>

                <!-- Pregunta 55 -->
                <label for="res55">55.  ¿Tenés interés por saber cuales son las causas que determinan ciertos fenómenos, aunque saberlo no altere tu vida?</label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res55" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res55" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 56 -->
                <label for="res56">56.  ¿Descubriste algún filósofo o escritor que haya expresado tus mismas ideas con antelación? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res56" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res56" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 57 -->
                <label for="res57">57. ¿Desearías que te regalen algún instrumento musical para tu cumpleaños? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res57" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res57" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 58 -->
                <label for="res58">58.  ¿Aceptarías colaborar con el cumplimiento de las normas en lugares públicos? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res58" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res58" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 59 -->
                <label for="res59">59.  ¿Crees que tus ideas son importantes,y haces todo lo posible para ponerlas en práctica? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res59" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res59" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 60 -->
                <label for="res60">60.  ¿Cuando se descompone un artefacto en tu casa, te disponés prontamente a repararlo?</label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res60" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res60" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 61 -->
                <label for="res61">61.  ¿Formarías parte de un equipo de trabajo orientado a la preservación de la flora y la fauna en extinción?</label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res61" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res61" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 62 -->
                <label for="res62">62.  ¿Acostumbrás a leer revistas relacionadas con los últimos avances científicos y tecnológicos en el área de la salud?  </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res62" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res62" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 63 -->
                <label for="res63">63.  ¿Preservar las raíces culturales de nuestro país, te parece importante y necesario? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res63" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res63" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 64 -->
                <label for="res64">64. ¿Te gustaría realizar una investigación que contribuyera a hacer más justa la distribución de la riqueza? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res64" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res64" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 65 -->
                <label for="res65">65. ¿Te gustaría realizar tareas auxiliares en una nave, como por ejemplo izado y arriado de velas, pintura y conservación del casco, arreglo de averías, conservación de motores, etc? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res65" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res65" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Pregunta 66 -->
                <label for="res66">66. ¿Crees que un país debe poseer la más alta tecnología armamentista, a cualquier precio? </label>
                <div class="options-group">
                  <br>
                  <input type="radio" id="areaA" name="res66" value="A">                    
                  <label for="areaA">Si</label>
                    <br>
                    
                    <input type="radio" id="areaB" name="res66" value="B">                    
                    <label for="areaB">No</label>
                </div>
                <br><br>

                <!-- Final de preguntas-->
            </div>
            <div class="custom-popup" id="customPopup" style="color: white">
              <span class="popup-message" id="popupMessage"></span>
            </div>
            <!-- Boton para pasar a las siguientes preguntas-->
            <a href="http://127.0.0.1:8000/Skillmap/Empezar/Evaluaciones/Chaside4">
              <button type="button">Siguiente</button>
          </a>          
        </form>
    </div>
  </div>
  <br><br><br><br><br><br><br><br><br>
  <footer>
      <p>
          <i class="fa-solid fa-envelope"></i> <a href="mailto:skillmap2024@gmail.com"> skillmap2024@outlook.com</a><span style="margin-right: 100px;"></span>
          <i class="fa fa-phone"></i> <a href="tel:5611670871"> 5611670871</a>
      </p>
      <p>&copy; 2023 Skillmap. Todos los derechos reservados</p>
  </footer>
</body>
<script>
  async function verificarAutenticacion() {
    const response = await fetch('http://127.0.0.1:8000/user/me', {
      method: 'GET',
      headers: {
        'Authorization': 'Bearer ' + localStorage.getItem('access_token')
      }
    });
    window.data = await response.json();
    data = window.data
    if (!response.ok || data.error) {
      window.location.href = 'http://127.0.0.1:8000/Skillmap/';
    }else{
      document.querySelector('header').style.opacity = 1;
      cargarRespuestas();
    }
  }
  async function cargarRespuestas() {
    try {
      const response = await fetch(`http://127.0.0.1:8000/answers?correo=${encodeURIComponent(data.correo)}`, {
        method: 'GET',
        headers: {
          'Authorization': 'Bearer ' + localStorage.getItem('access_token')
        }
      });
      const respuestasUsuario = await response.json();
      for (const [pregunta, respuesta] of Object.entries(respuestasUsuario)) {
        const radioButton = document.querySelector(`input[name="${pregunta}"][value="${respuesta}"]`);
        if (radioButton) {
          radioButton.checked = true;
        }
      }
    } catch (error) {
      console.error('Error al cargar respuestas:', error.message);
    }
  }
  verificarAutenticacion();
  document.getElementById('cerrar_sesion').addEventListener('click', function() {
    localStorage.removeItem('access_token');
    window.location.href = 'http://127.0.0.1:8000/Skillmap/';
  });

  document.addEventListener("DOMContentLoaded", function() {
    const form = document.getElementById("vocational-form");

    const radioButtons = form.querySelectorAll('input[type="radio"]');
    radioButtons.forEach(function(radioButton) {
      radioButton.addEventListener("change", function() {
        const pregunta = radioButton.getAttribute("name");
        const respuesta = radioButton.value;
        actualizarBaseDeDatos(pregunta, respuesta);
      });
    });
  });

  async function actualizarBaseDeDatos(parametro, valor) {
    correo = (window.data).correo
    const response = await fetch(`http://127.0.0.1:8000/answers?correo=${encodeURIComponent(correo)}&parametro=${parametro}&valor=${valor}`,{
      method: 'PATCH',
      headers: {
          'Content-Type': 'application/json',
      },
    });
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
  }
  document.getElementById('enviarRespuestas').addEventListener('click', async function() {
    let formLleno = true
    try {
      const response = await fetch(`http://127.0.0.1:8000/answers?correo=${encodeURIComponent(data.correo)}`, {
        method: 'GET',
        headers: {
          'Authorization': 'Bearer ' + localStorage.getItem('access_token')
        }
      });
      const respuestasUsuario = await response.json();
      for (const [pregunta, respuesta] of Object.entries(respuestasUsuario)) {
        if (respuesta === " "){
          formLleno = false;
          break;
        }
      }
      if (!formLleno){
        showCustomPopup("Completa el formulario antes de continuar",2000,"#ec5353")
      }else{
        console.log("form_completo")
        actualizarBaseDeDatos("formulario", true)
        setTimeout(() => {
          window.location.href = 'http://127.0.0.1:8000/Skillmap/Empezar';
      }, 1000);
      }
    } catch (error) {
      console.error('Error al cargar respuestas:', error.message);
    }
  });
  function showCustomPopup(message, duration, backgroundColor) {
    const customPopup = document.getElementById('customPopup');
    const popupMessage = document.getElementById('popupMessage');

    customPopup.style.backgroundColor = backgroundColor;

    popupMessage.textContent = message;
    customPopup.style.display = 'block';

    customPopup.style.animation = 'slideDown 0.5s';

    setTimeout(() => {
        customPopup.style.animation = 'slideUp 0.5s';
        setTimeout(() => {
            customPopup.style.display = 'none';
            customPopup.style.animation = '';
        }, 500);
    }, duration);
  }
</script>
</html>