<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="http://127.0.0.1:8000/static/Logo.ico">  
    <title>Mi cuenta</title>
    <link rel="stylesheet" href="http://127.0.0.1:8000/static/Evaluaciones/styles.css">
    <style>header{opacity: 0;}</style>
</head>

<body>
  <header>
    <img class="logoimg" src="http://127.0.0.1:8000/static/Login/Logo.png">
    <span class="logo">Skillmap</span>
    <nav>
        <div id="navbar">
            <a href="http://127.0.0.1:8000/Skillmap/Inicio">Inicio</a>
            <a href="http://127.0.0.1:8000/Skillmap/evaluaciones">Mi cuenta</a>
            <a href="http://127.0.0.1:8000/Skillmap/AboutUs">Acerca de</a>
            <a href="http://127.0.0.1:8000/Skillmap/Contacto">Contacto</a>
            <a href="#" id="cerrar_sesion">Cerrar sesión</a>
        </div>
    </nav>
  </header>

  <div class="evaluaciones-container">
    <div class="evaluaciones-main">
      <div class="evaluaciones-section chaside">
        <h2>Test Chaside</h2>
        <div class="evaluaciones-description">El test de Chaside se centra en evaluar tanto los intereses como las aptitudes de los individuos en relación con distintas áreas académicas y profesionales.</div>
        <div class="evaluaciones-actions">
          <a href="http://127.0.0.1:8000/Skillmap/Empezar/Evaluaciones/Chaside" id="button-chaside" class="cta-button">Iniciar test</a>
        </div>
      </div>

      <div class="evaluaciones-section kuder">
        <h2>Test Kuder</h2>
        <div class="evaluaciones-description">El test de Kuder busca identificar qué actividades resultan más atractivas para el individuo, y ayuda a orientarlo hacia campos donde encontrará mayor satisfacción y motivación.</div>
        <div class="evaluaciones-actions">
          <a href="http://127.0.0.1:8000/Skillmap/Empezar/Evaluaciones/Kuder" id="button-kuder" class="cta-button">Iniciar test</a>
        </div>
      </div>

      <div class="evaluaciones-section holland">
        <h2>Test Holland</h2>
        <div class="evaluaciones-description">El test de Holland ayuda a relacionar los tipos de personalidad con los entornos laborales adecuados, sugiriendo qué tipo de carreras podrían ser más satisfactorias en función de la personalidad de cada individuo.</div>
        <div class="evaluaciones-actions">
          <a href="http://127.0.0.1:8000/Skillmap/Empezar/Evaluaciones/Holland" id="button-holland" class="cta-button">Iniciar test</a>
        </div>
      </div>
    </div>
  </div>
  <footer>
    <p>
        </i> <a href="mailto:skillmap2024@gmail.com"> skillmap2024@outlook.com</a><span style="margin-right: 100px;"></span>
        </i> <a href="tel:5611670871"> 5611670871</a>
        
    </p>
    <p>&copy; 2023 Skillmap. Todos los derechos reservados</p>
  </footer>
</body>
<script>
  async function verificarAutenticacion() {
    const response = await fetch('http://127.0.0.1:8000/user/me', {
        method: 'GET',
        headers: {
            'Authorization': 'Bearer ' + localStorage.getItem('access_token')
        }
    });
    const data = await response.json();
    if (!response.ok || data.error) {
        window.location.href = 'http://127.0.0.1:8000/Skillmap/';
    }else{
        document.querySelector('header').style.opacity = 1;
        let respuestasCUsuario;
        let respuestasHUsuario;
        let respuestasKUsuario;
        try {
          const response = await fetch(`http://127.0.0.1:8000/answersC?correo=${encodeURIComponent(data.correo)}`, {
            method: 'GET',
            headers: {
              'Authorization': 'Bearer ' + localStorage.getItem('access_token')
            }
          });
          respuestasCUsuario = await response.json();
        } catch (error) {
          console.error('Error al cargar respuestas:', error.message);
        }
        try {
          const response = await fetch(`http://127.0.0.1:8000/answersK?correo=${encodeURIComponent(data.correo)}`, {
            method: 'GET',
            headers: {
              'Authorization': 'Bearer ' + localStorage.getItem('access_token')
            }
          });
          respuestasKUsuario = await response.json();
        } catch (error) {
          console.error('Error al cargar respuestas:', error.message);
        }
        try {
          const response = await fetch(`http://127.0.0.1:8000/answersH?correo=${encodeURIComponent(data.correo)}`, {
            method: 'GET',
            headers: {
              'Authorization': 'Bearer ' + localStorage.getItem('access_token')
            }
          });
          respuestasHUsuario = await response.json();
        } catch (error) {
          console.error('Error al cargar respuestas:', error.message);
        }
        if (respuestasCUsuario.formularioC === true) {
          const ctaButtonChaside = document.getElementById('button-chaside');
          ctaButtonChaside.textContent = 'Ver respuestas';
        }
        if (respuestasKUsuario.formularioK === true) {
          const ctaButtonChaside = document.getElementById('button-kuder');
          ctaButtonChaside.textContent = 'Ver respuestas';
        }
        if (respuestasHUsuario.formularioH === true) {
          const ctaButtonChaside = document.getElementById('button-holland');
          ctaButtonChaside.textContent = 'Ver respuestas';
        }
    }
  }
  verificarAutenticacion();
  document.getElementById('cerrar_sesion').addEventListener('click', function() {
    localStorage.removeItem('access_token');
    window.location.href = 'http://127.0.0.1:8000/Skillmap/';
  });
</script>
</html>